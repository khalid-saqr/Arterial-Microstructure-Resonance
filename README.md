# Resonant Coupling Regime in Pulsatile Arterial Flow

This repository contains the source code and data analysis scripts associated with the manuscript:

**"Microstructure-Induced Anisotropic Resonance in Compliant Arteries"**

**Author:** Khalid Saqr  
**Affiliation:** Department of Mechanical Engineering, College of Engineering and Technology, Arab Academy for Science, Technology and Maritime Transport, Alexandria, Egypt.  
**ORCID:** 0000-0002-3058-2705
## Abstract
The mechanistic link between cellular alignment and macroscopic transport is established through a nonlinear reduced-order framework for pulsatile flow. Blood is modeled with a dynamic microstructure tensor $\bm{A}$, inducing an anisotropic viscous stress that interacts with wall compliance. Analysis reveals a fundamental coupling governed by the microstructural Deborah number $De_A = \omega_0 T_A$. A distinct anisotropic resonance is identified at $De_A \approx 1$, where microstructural relaxation synchronizes with the cardiac cycle to maximize energy dissipation and waveform distortion. By delineating isotropic ($De_A \ll 1$), resonant, and frozen ($De_A \gg 1$) regimes, the spectral complexity observed in \emph{in vivo} data is physically explained, providing a tractable continuum alternative to phenomenological closures in cardiovascular mechanobiology.

## Repository Contents

### 1. Theoretical Framework
* **File:** `PulsatileWavePropagation.ipynb`
* **Description:** Implements the core mathematical model of the study. It solves the governing equations for the microstructure-aware fluid model, generates regime maps, and analyzes waveform distortion phenomena.
* **Key Physics:** Covers the coupling of Womersley flow with relaxation-driven microstructure evolution.

### 2. Physiological Validation
* **File:** `ConsistencyWithMIMIC-III.ipynb`
* **Description:** Provides physiological context using open-access data from the MIMIC-III Waveform Database. It processes arterial blood pressure (ABP) measurements to validate theoretical diagnostics.
* **Outputs:** Spectral analysis of in vivo waveforms demonstrating low-order spectral dominance and harmonic content.

### Paper Data & Provenance

This directory contains the metadata, processed spectral metrics, and provenance records used to generate the physiological validation results presented in the manuscript section: **"Consistency with in vivo measurements"**.

#### Data Source
* **Origin:** [MIMIC-III Waveform Database (PhysioNet)](https://physionet.org/content/mimic3wdb/1.0/)
* **Data Type:** Invasive Arterial Blood Pressure (ABP) waveforms.
* **Access Policy:** The raw waveform data files (`.hea`, `.dat`) are not hosted here due to PhysioNet credentialing and distribution restrictions. They must be accessed directly from PhysioNet using the provenance keys provided below.

#### Contents

##### 1. Cohort Provenance
* **File:** `mimic3_records_metadata.csv` (or `.json`)
* **Description:** Contains the specific identifiers required to retrieve the exact waveform segments analyzed in the paper.
* **Columns/Keys:**
    * `Subject_ID`: The randomized MIMIC-III subject identifier.
    * `Record_Path`: The directory path in the PhysioNet database (e.g., `p00/p000020/`).
    * `Segment`: The specific waveform segment name.
    * `Channel`: The index or label of the ABP channel extracted.

##### 2. Processed Spectral Metrics
* **File:** `invivo_harmonic_metrics.csv`
* **Description:** The intermediate dataset generated by `ConsistencyWithMIMIC-III.ipynb`. This file contains the computed spectral properties for each analyzed cardiac cycle, used to plot Figures 4, 5, and 6.
* **Variables:**
    * `E_k`: Harmonic energy spectrum values.
    * `Cumulative_Energy_90/95/99`: Truncation orders required to meet energy thresholds.
    * `Distortion_Index`: The computed Waveform Distortion Index ($D$).
    * `Spectral_Entropy`: Auxiliary complexity measures.

### Reproducibility

To reproduce the analysis starting from raw data:
1.  Obtain credentialed access to MIMIC-III on PhysioNet.
2.  Configure your `wfdb` library with your PhysioNet credentials.
3.  Run the `notebooks/ConsistencyWithMIMIC-III.ipynb` script. It will read the **Cohort Provenance** file from this folder, download the requested segments on-the-fly, and regenerate the **Processed Spectral Metrics**.

## Installation & Requirements

To run these notebooks locally, you will need Python 3 and the following dependencies:

```bash
pip install numpy scipy matplotlib pandas wfdb jupyterlab
```

* **`wfdb`**: Required for accessing and processing physiological signals from PhysioNet (MIMIC-III).
* **`numpy` & `scipy`**: For numerical solvers and FFT operations.
* **`matplotlib`**: For generating the manuscript figures.

## Usage

1.  Clone this repository:
    ```bash
    git clone [https://github.com/your-username/Arterial-Microstructure-Resonance.git](https://github.com/your-username/Arterial-Microstructure-Resonance.git)
    ```
2.  Navigate to the directory:
    ```bash
    cd Arterial-Microstructure-Resonance
    ```
3.  Launch Jupyter Lab:
    ```bash
    jupyter lab
    ```

## Citation

If you use this code or the theoretical framework in your research, please cite the accompanying paper:

> Saqr, K. (2026). Microstructure-Induced Anisotropic Resonance in Compliant Arteries *[preprint]*.

## License

This project is licensed under the MIT License - see the `LICENSE` file for details.
